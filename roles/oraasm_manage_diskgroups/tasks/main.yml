---
# @todo bug: missing loop_control

- name: oraasm_manage_diskgroups | Manage diskgroups
  opitzconsulting.ansible_oracle.oracle_asmdg:
    un: sys
    pw: "{{ sysasmpassword }}"
    sn: +ASM
    host: "{{ oracle_hostname }}"
    oh: "{{ oracle_home_gi }}"
    name: "{{ item.diskgroup }}"
    disks: "{{ _oraasm_manage_diskgroups_asmdevice_list }}"
    redundancy: "{{ item.redundancy | default(omit) }}"
    attribute_name: "{{ _oraasm_manage_diskgroups_attr_name | default(omit) }}"
    attribute_value: "{{ _oraasm_manage_diskgroups_attr_value | default(omit) }}"
    state: "{{ item.state }}"
  environment: "{{ _grid_env }}"
  run_once: "{{ _oraswgi_meta_configure_cluster }}"
  become_user: "{{ _grid_install_user }}"
  with_items: "{{ asm_diskgroups }}"
  tags: diskgroup
