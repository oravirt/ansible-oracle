#!/bin/bash
#
# {{ ansible_managed }}
#
# DO NOT EDIT THIS FILE!
#
# This file is under control of ansible-oracle.
#
# Please configure the -mtime with oracle_cleanup_days and oracle_trace_cleanup_days in Ansible

# Remove Auditfiles from Filesystem
for audit in {{oracle_base}}/admin/*/adump {{ oracle_home_gi }}/rdbms/audit
do
  find ${audit} -name "*.aud"  -type f -mtime +{{oracle_cleanup_days}}  -delete 2>/dev/null
  find ${audit} -name "*.xml"  -type f -mtime +{{oracle_cleanup_days}}  -delete 2>/dev/null
done

# Remove all xml-Files from ADR
# We ignore, that individual cleanups are existing in ADR
find {{oracle_base}}/diag/rdbms/*/*/alert -name "*.xml"  -type f -mtime +{{oracle_cleanup_days}}  -delete 2>/dev/null
find {{oracle_base}}/diag/asm/*/*/alert -name "*.xml"  -type f -mtime +{{oracle_cleanup_days}}  -delete 2>/dev/null

# Remove Tracefiles from ADR
# We ignore a possible policy in ADR
find {{oracle_base}}/diag/rdbms/*/*/trace -name "*.tr?"  -type f -mtime +{{oracle_trace_cleanup_days}}  -delete 2>/dev/null
find {{oracle_base}}/diag/asm/*/*/trace -name "*.tr?"  -type f -mtime +{{oracle_trace_cleanup_days}}  -delete 2>/dev/null

#
find {{oracle_base}}/diag/tnslsnr/*/*/alert -name "*.xml"  -type f -mtime +{{oracle_cleanup_days}}  -delete 2>/dev/null
